<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Warehouse Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        form {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
        }

        input,
        select,
        button {
            margin: 5px;
            padding: 5px;
        }

        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        /* Flash Messages */
        .flash-messages {
            list-style-type: none;
            padding: 0;
            margin: 15px 0;
        }

        .flash-messages li {
            padding: 12px 20px;
            border-radius: 5px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .flash-messages li.success {
            background-color: #28a745;
            color: white;
        }

        .flash-messages li.error {
            background-color: #dc3545;
            color: white;
        }

        .flash-messages li.warning {
            background-color: #ffc107;
            color: #333;
        }
    </style>
</head>

<body>
    <h1>Warehouse Management System</h1>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <ul class="flash-messages">
        {% for category, message in messages %}
        <li class="{{ category }}">{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    {% endwith %}

    <!-- Form to add a new item -->
    <h2>Add New Item</h2>
    <form method="POST" action="{{ url_for('add_item') }}">
        <label>Serial Number:</label>
        <input type="text" name="serial_number" required><br>

        <label>Kanban Location:</label>
        <input type="text" name="kanban_location" required placeholder="e.g., R1_A4_01"><br>

        <label>Status:</label>
        <select name="Status" required>
            <option value="">Select Status</option>
            <option value="In Storage">In Storage</option>
            <option value="Out Storage">Out Storage</option>
        </select><br>

        <button type="submit">Add Item</button>
    </form>

    <hr>

    <!-- Display existing items -->
    <h2>Current Inventory</h2>
    <table>
        <thead>
            <tr>
                <th>Serial Number</th>
                <th>Kanban Location</th>
                <th>Status</th>
                <th>Last Update In</th>
                <th>Last Update Out</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>{{ item[0] }}</td> <!-- Serial_Number -->
                <td>{{ item[1] }}</td> <!-- Kanban_Location -->
                <td>{{ item[2] }}</td> <!-- Status -->
                <td>{{ item[3] if item[3] else 'N/A' }}</td> <!-- Last_Update_In -->
                <td>{{ item[4] if item[4] else 'N/A' }}</td> <!-- Last_Update_Out -->
                <td>
                    <!-- Form to update status -->
                    <form method="POST" action="{{ url_for('update_status', serial=item[0]) }}"
                        style="display: inline;">
                        <select name="status" onchange="this.form.submit()">
                            <option value="">Change Status</option>
                            <option value="In Storage" {% if item[2]=='In Storage' %}selected{% endif %}>In Storage
                            </option>
                            <option value="Out Storage" {% if item[2]=='Out Storage' %}selected{% endif %}>Out Storage
                            </option>
                        </select>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6">No items found in warehouse</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>

</html>